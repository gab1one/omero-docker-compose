version: '2'
services:

  omero-data:
    container_name: omero-data
    build: omero-data
    command: "true"
    privileged: true
    volumes:
      - /OMERO:/data:Z

  omero-pg:
    container_name: omero-pg
    build: omero-postgres
    volumes_from:
      - omero-data
    environment:
      - PGDATA=/data/postgres

  omero-server:
    container_name: omero-server
    build: omero-server
    volumes_from:
      - omero-data
    links:
      - omero-pg:omero-db
    ports:
      - "4064:4064"

  omero-web:
    container_name: omero-web
    build: omero-web
    volumes_from:
      - omero-data
    links:
      - omero-server:omero_server
    ports:
      - "80:80"
      - "443:443"
      - "4080:4080"
    environment:
      - OMERO_WEB_USE_SSL=yes
      - OMERO_WEB_DEVELOPMENT=no
